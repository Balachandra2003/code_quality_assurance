name: C++ Code Quality Checks

on:
  push:
    branches:
      - main
      - feature/**
  pull_request:

jobs:
  lint-and-analyze:
    runs-on: windows-latest   # Can also use windows-latest if you prefer

    steps:
      - name: Checkout code
        uses: actions/checkout@v4

      # Install cpplint (Python package)
      - name: Install cpplint
        run: pip install cpplint

      # Install cppcheck (static analyzer)
      - name: Install cppcheck
        run: sudo apt-get update && sudo apt-get install -y cppcheck

      # Run cpplint on all C++ files
      - name: Run cpplint
        run: |
          echo "üîç Running cpplint..."
          files=$(find . -name "*.cpp" )
          if [ -z "$files" ]; then
            echo "‚úÖ No C++ files found."
          else
            cpplint $files
          fi

      # Run cppcheck on all C++ files
      - name: Run cppcheck
        run: |
          echo "üîç Running cppcheck..."
          files=$(find . -name "*.cpp" )
          if [ -z "$files" ]; then
            echo "‚úÖ No C++ files found."
          else
            cppcheck --enable=all --error-exitcode=1 $files
          fi
